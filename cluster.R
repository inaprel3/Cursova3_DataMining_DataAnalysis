#Кластеризація c-means
install.packages("ppclust")
library(ppclust)
#Для візуалізації результатів кластеризації використаємо пакети:
install.packages("factoextra")
library(factoextra)
install.packages("cluster")
library(cluster)
install.packages("fclust")
library(fclust)
#Продемонструємо FCM на наборі даних
setwd("E:/_DISCIPLINES_Programs/Cursova/") 
World_Happiness_Report_2022 <- read.csv("World_Happiness_Report_2022.csv") 
x=World_Happiness_Report_2022[,-5]
x
pairs(x, col=World_Happiness_Report_2022[,5])
#FCM запускається для трьох кластерів із значеннями за замовчуванням решти аргументів
res.fcm <- fcm(x, centers=5)
#Щоб використати певну матрицю прототипів кластерів для запуску алгоритму
v0 <- matrix(nrow=145, ncol=10,
             c(1,7.821,7.886,7.756,1.892,1.258,0.775,0.736,0.109,0.534,
               2,7.636,7.710,7.563,1.953,1.243,0.777,0.719,0.188,0.532,
               3,7.557,7.651,7.464,1.936,1.320,0.803,0.718,0.270,0.191,
               4,7.512,7.586,7.437,2.026,1.226,0.822,0.677,0.147,0.461,
               5,7.415,7.471,7.359,1.945,1.206,0.787,0.651,0.271,0.419,
               6,7.404,7.501,7.307,2.209,1.155,0.790,0.700,0.120,0.388,
               7,7.384,7.454,7.315,1.920,1.204,0.803,0.724,0.218,0.512,
               8,7.365,7.440,7.290,1.997,1.239,0.786,0.728,0.217,0.474,
               9,7.364,7.426,7.301,1.826,1.221,0.818,0.568,0.155,0.143,
               10,7.200,7.279,7.120,1.852,1.235,0.752,0.680,0.245,0.483,
               11,7.163,7.237,7.089,1.931,1.165,0.774,0.623,0.193,0.329,
               12,7.162,7.244,7.081,1.900,1.203,0.772,0.676,0.258,0.341,
               13,7.041,7.121,6.961,2.129,1.166,0.779,0.627,0.190,0.408,
               14,7.034,7.122,6.947,1.924,1.088,0.776,0.585,0.163,0.358,
               15,7.025,7.107,6.943,1.886,1.188,0.783,0.659,0.217,0.368,
               16,6.977,7.065,6.888,1.982,1.182,0.628,0.574,0.220,0.177,
               17,6.943,7.018,6.867,1.867,1.143,0.750,0.597,0.289,0.329,
               18,6.920,7.029,6.811,1.815,1.260,0.715,0.660,0.158,0.048,
               19,6.805,6.890,6.720,1.907,1.106,0.764,0.492,0.049,0.204,
               20,6.687,6.758,6.615,1.863,1.219,0.808,0.567,0.070,0.266,
               21,6.647,6.779,6.514,1.854,1.029,0.625,0.693,0.199,0.155,
               22,6.630,6.718,6.542,1.810,1.249,0.769,0.685,0.118,0.115,
               23,6.582,6.683,6.481,1.584,1.054,0.744,0.661,0.089,0.102,
               24,6.576,6.660,6.492,1.998,0.980,0.633,0.702,0.204,0.250,
               25,6.523,6.637,6.409,1.870,1.092,0.577,0.651,0.078,0.180,
               26,6.512,6.596,6.429,1.897,1.095,0.733,0.542,0.075,0.168,
               27,6.480,6.569,6.392,2.149,1.127,0.851,0.672,0.163,0.587,
               28,6.477,6.575,6.379,1.719,1.006,0.655,0.605,0.039,0.006,
               29,6.476,6.560,6.392,1.808,1.211,0.808,0.505,0.101,0.149,
               30,6.474,6.562,6.386,1.615,1.180,0.672,0.665,0.103,0.265,
               31,6.467,6.570,6.363,1.834,1.052,0.801,0.412,0.085,0.059,
               32,6.455,6.571,6.339,1.362,0.949,0.569,0.599,0.309,0.035,
               33,6.447,6.535,6.359,1.838,1.169,0.789,0.679,0.174,0.166,
               34,6.446,6.535,6.356,1.804,1.204,0.659,0.496,0.053,0.077,
               35,6.391,6.475,6.306,1.736,1.232,0.707,0.479,0.118,0.025,
               36,6.341,6.415,6.266,1.793,1.232,0.728,0.689,0.123,0.333,
               37,6.309,6.464,6.154,1.715,1.107,0.709,0.592,0.049,0.051,
               38,6.293,6.384,6.202,1.462,1.044,0.615,0.546,0.131,0.134,
               39,6.262,6.460,6.064,1.274,0.831,0.522,0.662,0.112,0.115,
               40,6.234,6.330,6.138,1.668,1.220,0.611,0.584,0.134,0.157,
               41,6.221,6.320,6.122,1.815,0.909,0.819,0.448,0.123,0.062,
               42,6.180,6.255,6.106,1.732,1.221,0.637,0.502,0.075,0.090,
               43,6.178,6.294,6.062,1.550,1.086,0.658,0.546,0.219,0.088,
               44,6.172,6.262,6.082,1.651,1.080,0.748,0.460,0.124,0.069,
               45,6.165,6.312,6.017,1.105,1.029,0.617,0.617,0.168,0.212,
               46,6.128,6.238,6.017,1.552,0.886,0.623,0.621,0.092,0.115,
               47,6.125,6.229,6.022,1.705,1.183,0.709,0.535,0.109,0.000,
               48,6.123,6.205,6.040,1.758,1.174,0.712,0.523,0.124,0.140,
               49,6.120,6.250,5.990,1.265,0.768,0.607,0.666,0.089,0.212,
               50,6.106,6.235,5.977,1.904,0.983,0.747,0.617,0.087,0.147,
               51,6.086,6.187,5.985,1.748,1.233,0.668,0.485,0.078,0.064,
               52,6.071,6.184,5.958,1.591,1.116,0.568,0.589,0.131,0.107,
               53,6.063,6.178,5.948,1.219,1.092,0.600,0.716,0.283,0.240,
               54,6.039,6.119,5.959,1.835,1.089,0.866,0.537,0.007,0.218,
               55,6.022,6.189,5.855,1.111,0.885,0.555,0.582,0.202,0.076,
               56,6.016,6.122,5.911,1.760,1.078,0.777,0.655,0.016,0.039,
               57,5.967,6.090,5.844,1.592,1.102,0.662,0.555,0.081,0.085,
               58,5.948,6.043,5.853,1.703,0.980,0.774,0.249,0.015,0.108,
               59,5.935,6.021,5.849,1.851,0.886,0.841,0.414,0.111,0.176,
               60,5.904,6.007,5.800,1.268,0.912,0.514,0.678,0.107,0.142,
               61,5.891,5.994,5.788,1.535,1.096,0.697,0.617,0.321,0.026,
               62,5.857,5.948,5.766,1.417,1.008,0.597,0.561,0.102,0.028,
               63,5.850,6.023,5.676,1.296,1.045,0.646,0.567,0.080,0.053,
               64,5.828,5.916,5.741,1.069,1.109,0.638,0.693,0.208,0.025,
               65,5.821,5.950,5.693,1.562,1.157,0.629,0.342,0.040,0.282,
               66,5.781,5.903,5.659,1.452,0.929,0.720,0.545,0.087,0.077,
               67,5.768,5.877,5.659,1.468,1.068,0.665,0.448,0.244,0.006,
               68,5.761,5.845,5.676,1.393,1.197,0.467,0.398,0.247,0.059,
               69,5.737,5.873,5.601,1.538,1.003,0.577,0.606,0.084,0.179,
               70,5.711,5.845,5.578,1.689,0.938,0.620,0.654,0.213,0.126,
               71,5.600,5.709,5.491,1.256,0.880,0.555,0.627,0.112,0.064,
               72,5.585,5.650,5.520,1.508,0.958,0.705,0.656,0.099,0.142,
               73,5.578,5.689,5.467,1.409,1.130,0.624,0.629,0.171,0.059,
               74,5.559,5.679,5.439,1.397,0.865,0.735,0.545,0.090,0.037,
               75,5.547,5.681,5.413,1.573,1.023,0.659,0.460,0.135,0.077,
               76,5.533,5.653,5.414,1.352,0.879,0.708,0.565,0.080,0.083,
               77,5.485,5.570,5.400,1.252,0.932,0.611,0.707,0.143,0.105,
               78,5.474,5.578,5.371,1.484,1.319,0.516,0.649,0.314,0.032,
               79,5.467,5.609,5.325,1.815,0.888,0.819,0.523,0.130,0.213,
               80,5.425,5.501,5.348,1.957,0.954,0.942,0.400,0.147,0.383,
               81,5.399,5.519,5.278,1.434,0.820,0.668,0.558,0.054,0.210,
               82,5.377,5.468,5.287,0.966,1.005,0.518,0.572,0.118,0.304,
               83,5.377,5.502,5.251,0.984,0.784,0.499,0.519,0.237,0.130,
               84,5.371,5.485,5.257,1.625,1.163,0.640,0.563,0.123,0.021,
               85,5.330,5.543,5.118,1.476,0.943,0.606,0.477,0.106,0.179,
               86,5.240,5.341,5.139,1.382,0.883,0.539,0.620,0.468,0.047,
               87,5.235,5.384,5.085,1.094,0.442,0.322,0.451,0.149,0.124,
               88,5.199,5.303,5.095,1.505,0.863,0.637,0.488,0.215,0.031,
               89,5.199,5.321,5.076,1.439,0.646,0.719,0.511,0.138,0.028,
               90,5.194,5.315,5.073,1.425,1.088,0.361,0.442,0.089,0.046,
               91,5.173,5.265,5.082,1.458,1.093,0.560,0.601,0.023,0.341,
               92,5.164,5.409,4.918,0.785,0.621,0.369,0.367,0.388,0.103,
               93,5.155,5.262,5.049,1.060,0.614,0.581,0.622,0.125,0.187,
               94,5.140,5.263,5.018,1.239,0.654,0.479,0.679,0.197,0.184,
               95,5.122,5.215,5.030,1.363,0.970,0.643,0.146,0.106,0.150,
               96,5.122,5.428,4.815,0.636,0.670,0.309,0.405,0.178,0.080,
               97,5.084,5.190,4.978,1.411,1.081,0.583,0.473,0.188,0.017,
               98,5.075,5.235,4.915,0.950,0.405,0.355,0.431,0.130,0.146,
               99,5.060,5.181,4.938,1.208,0.268,0.565,0.492,0.020,0.102,
               100,5.048,5.273,4.823,0.578,0.660,0.191,0.593,0.185,0.200,
               101,5.048,5.188,4.907,0.968,0.672,0.317,0.397,0.152,0.074,
               102,5.046,5.171,4.921,0.933,0.530,0.447,0.494,0.143,0.081,
               103,5.003,5.247,4.760,0.570,0.560,0.326,0.571,0.165,0.145,
               104,4.973,5.079,4.867,1.467,0.612,0.595,0.508,0.000,0.208,
               105,4.958,5.091,4.826,1.459,0.738,0.396,0.343,0.032,0.099,
               106,4.941,5.099,4.783,1.289,0.682,0.554,0.328,0.147,0.046,
               107,4.925,5.051,4.800,0.000,0.968,0.578,0.283,0.225,0.082,
               108,4.891,5.028,4.753,0.848,0.566,0.275,0.334,0.214,0.116,
               109,4.888,4.995,4.780,1.410,0.741,0.642,0.281,0.241,0.146,
               110,4.872,4.999,4.745,1.112,0.595,0.409,0.500,0.230,0.056,
               111,4.744,4.845,4.644,1.707,0.865,0.702,0.209,0.087,0.115,
               112,4.670,4.814,4.527,0.779,0.565,0.320,0.382,0.186,0.126,
               113,4.640,4.765,4.516,1.019,0.732,0.505,0.740,0.166,0.068,
               114,4.623,4.754,4.492,0.932,0.064,0.335,0.479,0.127,0.230,
               115,4.609,4.849,4.368,0.899,0.476,0.424,0.185,0.195,0.125,
               116,4.603,4.747,4.459,0.777,0.875,0.418,0.402,0.222,0.066,
               117,4.552,4.651,4.453,1.079,0.732,0.300,0.444,0.175,0.038,
               118,4.543,4.683,4.403,1.032,0.605,0.401,0.440,0.322,0.082,
               119,4.516,4.629,4.403,1.350,0.596,0.656,0.316,0.029,0.029,
               120,4.516,4.634,4.397,1.049,0.413,0.374,0.448,0.181,0.112,
               121,4.483,4.665,4.300,1.148,0.957,0.521,0.336,0.073,0.079,
               122,4.479,4.611,4.347,0.792,0.483,0.311,0.350,0.128,0.042,
               123,4.459,4.593,4.326,1.292,0.877,0.354,0.384,0.067,0.071,
               124,4.396,4.607,4.185,1.274,0.786,0.197,0.259,0.038,0.154,
               125,4.394,4.511,4.277,1.038,0.829,0.491,0.513,0.452,0.194,
               126,4.362,4.487,4.237,1.415,0.934,0.660,0.529,0.150,0.079,
               127,4.339,4.530,4.148,0.670,0.645,0.378,0.202,0.143,0.154,
               128,4.288,4.377,4.198,1.388,0.732,0.548,0.469,0.041,0.254,
               129,4.251,4.503,3.999,0.662,0.506,0.225,0.180,0.182,0.077,
               130,4.241,4.365,4.118,0.788,0.809,0.457,0.472,0.205,0.136,
               131,4.197,4.384,4.010,0.691,1.043,0.384,0.330,0.090,0.098,
               132,4.153,4.356,3.950,1.100,0.865,0.450,0.304,0.088,0.138,
               133,4.152,4.276,4.029,1.324,0.724,0.675,0.476,0.058,0.200,
               134,4.112,4.272,3.953,0.771,0.322,0.360,0.292,0.174,0.132,
               135,3.777,3.828,3.726,1.167,0.376,0.471,0.647,0.198,0.123,
               136,3.760,3.902,3.618,0.930,0.577,0.306,0.525,0.203,0.083,
               137,3.750,3.941,3.560,0.648,0.279,0.388,0.477,0.140,0.157,
               138,3.702,3.847,3.558,0.848,0.597,0.425,0.578,0.248,0.270,
               139,3.574,3.732,3.416,0.686,0.416,0.273,0.387,0.202,0.055,
               140,3.512,3.748,3.276,0.839,0.848,0.000,0.419,0.076,0.018,
               141,3.471,3.667,3.275,1.503,0.815,0.280,0.571,0.012,0.102,
               142,3.268,3.462,3.074,0.785,0.133,0.462,0.621,0.187,0.544,
               143,2.995,3.110,2.880,0.947,0.690,0.270,0.329,0.106,0.105,
               144,2.955,3.049,2.862,1.392,0.498,0.631,0.103,0.082,0.034,
               145,2.404,2.469,2.339,0.758,0.000,0.289,0.000,0.089,0.005),
             byrow=TRUE)
print(v0)
#res.fcm <- fcm(x, centers=v0)
